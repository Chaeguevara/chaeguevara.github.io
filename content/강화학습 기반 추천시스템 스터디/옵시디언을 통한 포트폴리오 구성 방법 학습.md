
## 1 목표
옵시디언으로 작성한 결과물을 포트폴리오 또는 블로그 운영을 위해 쓰는 방법에 대해 학습합니다.

## 2 준비물
- [Quartz4](https://quartz.jzhao.xyz/)
- [옵시디언](https://obsidian.md/)
- WSL ,Mac 및 기타 관련 패키지 설치가 무리없는 환경
- [nvm](https://www.freecodecamp.org/news/node-version-manager-nvm-install-guide/) 또는 [node.js](https://nodejs.org/en)(Quartz4 설치 위해 필요)

## 3 옵시디언

### 3.1 옵시디언이란?
![[Pasted image 20230929002126.png]](Obsidian 공식 설명)

노션의 업그레이드 판 정도로 해석가능함. 실제 문법은 markdown을 통해 이루어짐. Notion에 비해 문서 간 연결 기능이 잘 구성되어 있는 것이 장점이라고 볼 수 있음

![[Pasted image 20230929002504.png]](Graph 예시 이미지)

위 그림처럼 각 문서간 연결관계를 표시할 수 있음. 아직 좀더 테스트를 해봐야 하지만, 문서 안에 일일이 정리를 해야하는 점은 다소 불편할 수 있음. **자신이 적은 지식이 하나의 자산이되고, 이를 바로 포트폴리오 화 할수 있을 것으로 예상함**.
### 3.2 설치방법 및 Vault설정
[설치링크](https://obsidian.md/download)를 통해 설치 가능함. Vault는 하나의 저장소라고 볼 수 있음. 본인이 원하는 이름의 Vault를 만들면 됨. Mac유저의 경우 iCloud에 올리면 모바일 앱을 통해 모바일 상황에서 수정이 가능함. Remote Valut라는 기능은 있던데 제대로 작동하지 않아 사용하지 않음
![[Pasted image 20230929003520.png]](icloud 설치 이미지)


## 4 Quartz4
웹페이지 만드는 프레임워크 중 하나로 보임. Fork 수가 많고 Obsidian 기능 중 Graph View를 무리없이 재활용 가능해보여 선정함. 사용방법은 [공식 문서](https://quartz.jzhao.xyz/)에 설명되어 있음. 관련 경험이 없다면 다소 어려울 수 있음. 여기서는 Minimal하게 작동하는 케이스만 설명함.

### 4.1 설치 방법
```shell
git clone https://github.com/jackyzha0/quartz.git
cd quartz
npm i
npx quartz create
```
위 구문을 뜯어보면 다음과 같다.
```shell
git clone https://github.com/jackyzha0/quartz.git
```
quartz의 git repo에서 다운로드를 받는다

```shell
cd quartz
```
repo를 다운로드 받으면 하위폴더가 생기는데, 이 위치로 이동한다

```shell
npm i
```
이 커맨드 때문에 [[#준비물]]에서 `node.js` 또는 `nvm`을 설치해야 했던 것

```shell
npx quartz create
```
npx에 대해서는 아직 내가 설명할 수 없다. 나중에 설명할 수 있기를. 설치할 때 알아들을 설정들이 나올텐데 두 설정에서 가장 위에있는 것들을 누르면 되었다. 즉, empty content와 
### 4.2 로컬 테스트
![[Pasted image 20230929023013.png]](로컬 설정 후 화면)

로컬 테스트는 빠르게 변경한 내용을 참조하기 위해 사용함. 웹에 배포시 한번 커밋마다 최소 10초 이상 소요되기 떄문임. 
```node
npx quartz build --serve
```
위 커맨드를 이용해 작동 시킬 수 있다. 하나의 커맨드 창에 설정한 후에 파일이 변경될때마다 알아서 웹페이지가 자동으로 동작된다.

### 4.3 온라인 설정
> [!INFO] Github page 호환성
> quartz4에서 권장하는 사항은 cloudflare로 배포하는 방법이기 때문에 cloudflare를 중심으로 다룬다. 현재 설정에서 github page는 제대로 작동하지 않는 오류가 존재한다.

#### 4.3.1 Github
깃허브의 경우 [quartz4](https://github.com/jackyzha0/quartz)를 fork하면 된다. fork시 내 repo에 들어오는 이름은 크게 신경 쓸 필요 없다. 추후에 변경도 가능하고, cloudflare로 넘길때 크게 상관없는 부분으로 보인다.

#### 4.3.2 Cloud flare
## 5 옵시디언 - Quartz4 자동화
위와같이 하면 매번 obsidian을 작성할때마다, 복사붙여넣기를 해야하는 번거로움이 존재한다. 이를 해결하기 위해서는 파일 내용 변화 감지 기능이 필요하다. `nodemon`이라는 `npm` 패키지를 이용하는 방식과 `fswatch`라는 shell 패키지(?)를 사용하는 방법이 있다. 여기서는 `fswatch`를 중심으로 설명한다

### 5.1 `fswatch`
> [!WARNING] 주의사항
> 현재 이 방식은 content 내부를 지우고 obsidian 안의 내용을 복사하는 방식이다. 그렇기 때문에 content에 원본 파일이 있을 시 삭제 되니 유의해야한다. 또한 fswatch를 이용하면 한 커맨드가 여러번 작동되어 `npx quartz build --serve` 쪽 프로세스가 꺼지는 현상이 있다.


#### 5.1.1 설치방법
mac은 당연히 brew를 통해 설치할 수 있다
```shell
brew install fswatch
```
#### 5.1.2 자동화 커맨드

우리가 하는 작업은 다음과 같은 단계를 거치게 된다

1. 만약 파일 내용이 변경되면(fswatch가 해주는 일)
2. 기존 폴더의 중복되는 내용을 삭제하고
3. obsidian vault의 내용을 복사한다

2,3번에 해당하는 삭제 및 복사 커맨드는 다음과 같다. 이 커맨드 이름을 `rmmv.sh`라고 하겠다
```bash
#!/bin/bash

echo "changed";
rm -rf your_quartz_upper/quartz/content/*;
cp -R your_vault_on_icloud/*  your_quartz_upper/quartz/content/;
```
위에 quartz의 content 위치와 본인의 obsidian valut위치를 넣으면 된다. 가령 나의 경우 아래와 같다.

```bash
#!/bin/bash

echo "changed";
rm -rf ~/Documents/2023/quartz/content/*;
cp -R ~/Library/Mobile\ Documents/iCloud~md~obsidian/Documents/MyFirstVault/*  ~/Documents/2023/quartz/content/;
```

위 내용을 복사한 `sh`파일을 만든 후 꼭 권한을 설정해 줘야한다. 즉, 아래의 커맨드를 한번 더 실행해줘야한다
```bash
chmod +x rmmv.sh
```
최초 파일이 생성될때 execution 권한이 설정되어 있지 않기 때문에 생긴 문제로 보인다.

### Nodemon 사용방법
[노드몬](https://www.npmjs.com/package/nodemon)은 원래 `node.js` 기반 앱을 만들때 자동으로 파일변화를 감지해주고 재시작을 해주는 라이브러리다. 그러나 global로 깔게되면 하나의 커맨드로 이용할 수 있다. 

#### global 설치
설치시, 바로 커맨트 창에서 접근할 수 있도록 global option을 이용해 설치해야한다. 방법은
```node
npm install -g nodemon
```




#포트폴리오 #quartz4 #cloudflare #iCloud #obsidian
